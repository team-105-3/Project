<!DOCTYPE html>
<html>
    <head>

        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css">

        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

        <!-- Popper JS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>

        <link rel="stylesheet" href="../css/loader.css">

        <title>My Calendar</title>

        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css">
        
        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        
        <!-- Popper JS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>
        
        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>

        <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.css" rel="stylesheet"/>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.css" rel="stylesheet"/>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js" ></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
        <meta charset="utf-8">

        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script src="../js/util.js"></script>
        <script src="../js/user/events.js"></script>
        <script src="../js/user/projects.js"></script>
        <script src="../js/calendar.js"></script>
        <script src="../js/user/user.js"></script>
        <link rel="stylesheet" href="../css/event.css">
        <link rel="stylesheet" href="../css/calendar.css">
    </head>
    <body>
        <div class="containter">
            <div class="wrapper">
                <div id="content">
                    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                        <ul class="navbar-nav mr-auto">
                            <li class='nav-item'>
                                <a class="navbar-brand" href="#" onclick="decUserDate()">&lt;</a>
                            </li>
                            <li class="nav-item">
                                <p class="navbar-brand" id="todays-date"> Today's Date </p>
                            </li>
                            <li class='nav-item'>
                                <a class="navbar-brand" href="#" onclick="incUserDate()">&gt;</a>
                            </li>
                        </ul>
                        <form class="form-inline my-2 my-lg-0">
                            <div class="c-btn" onclick="" data-toggle="modal" data-target="#createEventModal" id="createEvent">
                                <a>New Event</a>
                            </div>
                            <div class="c-btn" data-toggle="modal" data-target="#createProjectModal" id="createProject">
                                <a>New Project</a>
                            </div>
                        </form>
                    </nav>
                    <div class="calendar">
                        <table class="table table-bordered">
                            <thead>
                                <tr id="days-of-week"></tr>
                            </thead>
                            <tbody id="weekly-calendar">

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>


            <div class="modal" tabindex="-1" role="dialog" id="loading">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-body">
                            <div class="lds-grid"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!--Event Creation Modal-->
            <div class="modal fade" id="createEventModal" tabindex="-1" role="dialog" aria-labelledby="event-creation-modal" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Create Event</h5>
                        </div>
    
                        <!--Create Event Form-->
                        <div class="modal-body">
                            <!--Title-->
                            <div class="form-group">
                                <input type="text" class="form-control entry" id="e_title" placeholder="Event Title">
                            </div>
    
                            <!--Time-->
                            <div class="row">
                                <div class='col-sm-6'>
                                    <div class="form-group">
                                        <label for="e_start_time">Start Time</label>
                                        <div class='input-group date' id='datetimepicker1'>
                                            <input id="est" type='text' class="form-control entry" id="e_start_time"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#datetimepicker1').datetimepicker({
                                            format: 'LT'
                                        });
                                    });
                                </script>
                                <div class='col-sm-6'>
                                    <div class="form-group">
                                        <label for="e_end_time">End Time</label>
                                        <div class='input-group date' id='datetimepicker2'>
                                            <input id="eet" type='text' class="form-control entry" id="e_end_time"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#datetimepicker2').datetimepicker({
                                            format: 'LT'
                                        });
                                    });
                                </script>
                            </div>
    
                            <!--Recurring-->
                            <div class="form-check">
                                <div class="row">
                                    <div class="col col-sm-4">
                                        <label for="recurring"> Recurring Event </label>
                                    </div>
                                    <div class="col col-sm-1">
                                        <input class="form-check-input entry" type="checkbox" value="" id="recurring">
                                    </div>
                                </div>
                            </div>
    
                            <!--Date Input-->
                            <div class="row">
                                <div class='col-md-6'>
                                    <div class="form-group">
                                        <label for="e_start_date">Start Date</label>
                                        <div class='input-group date' id='e_start_date'>
                                            <input id="esd" type='text' class="form-control entry" />
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class='col-md-6'>
                                    <div class="form-group">
                                        <label for="e_end_date">End Date</label>
                                        <div class='input-group date' id='e_end_date'>
                                            <input disabled id="ed" type='text' class="form-control entry" />
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    document.getElementById('recurring').onchange = function() {
                                        document.getElementById('ed').disabled = !this.checked;
                                    };
                                </script>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#e_start_date').datetimepicker({
                                            format: "MM/DD/YYYY",
                                        });
                                        $('#e_end_date').datetimepicker({
                                            format: "MM/DD/YYYY",
                                            useCurrent: false //Important! See issue #1075
                                        });
                                        $("#e_start_date").on("dp.change", function (e) {
                                            $('#e_end_date').data("DateTimePicker").minDate(e.date);
                                        });
                                        $("#e_end_date").on("dp.change", function (e) {
                                            $('#e_start_date').data("DateTimePicker").maxDate(e.date);
                                        });
                                    });
                                </script>
                            </div>
                            
                            <div class="row">
                                <div class="col">
                                    <label for="rec">Recurrence</label>
                                    <select disabled class="custom-select mr-sm-2" id="rec">
                                        <option selected>Choose...</option>
                                        <option value="1">Every</option>
                                        <option value="2">Every Other</option>
                                    </select>
                                </div>
                                <div class="col">
                                    <label class="mr-sm-2" for="timeframe">Timeframe</label>
                                    <select disabled class="custom-select mr-sm-2 my-1" id="timeframe">
                                        <option selected>Choose...</option>
                                        <option value="1">Day</option>
                                        <option value="2">Week</option>
                                        <option value="3">Month</option>
                                        <option value="4">Year</option>
                                    </select>
                                </div>
                                <script>
                                    document.getElementById('recurring').onchange = function() {
                                        document.getElementById('rec').disabled = !this.checked;
                                        document.getElementById('timeframe').disabled = !this.checked;
                                        document.getElementById('ed').disabled = !this.checked;
                                    };
                                </script>
                            </div>
                            <br>
                            
                            <!--Description-->
                            <div class="form-group">
                                <label for="e_desc">Event Description</label>
                                <textarea class="form-control entry" id="e_desc" rows="3"></textarea>
                            </div>
                        </div>
    
                        <!--Cancel and submit buttons-->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="clearAllEntries()">Cancel</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="createCalendarEvent(updateUI)">Create Event</button>
                        </div>
                    </div>
                </div>
            </div>

            <!--Project Creation Modal-->
            <div class="modal fade" id="createProjectModal" tabindex="-1" role="dialog" aria-labelledby="project-creation-modal" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Create Project</h5>
                        </div>
    
                        <!--Create Project Form-->
                        <div class="modal-body">
                            <!--Title-->
                            <div class="form-group">
                                <input type="text" class="form-control entry" id="p_title" placeholder="Project Title">
                            </div>
    
                            <!--Time-->
                            <div class="row">
                                <div class='col-sm-6'>
                                    <div class="form-group">
                                        <label for="p_start_time">Start Date</label>
                                        <div class='input-group date' id='datetimepickerPS'>
                                            <input id="pst" type='text' class="form-control entry" id="p_start_time"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#datetimepickerPS').datetimepicker({
                                            format: "MM/DD/YYYY"
                                        });
                                    });
                                </script>
                                <div class='col-sm-6'>
                                    <div class="form-group">
                                        <label for="p_end_time">Due Date</label>
                                        <div class='input-group date' id='datetimepickerPE'>
                                            <input id="pet" type='text' class="form-control entry" id="p_end_time"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#datetimepickerPE').datetimepicker({
                                            format: "MM/DD/YYYY"
                                        });
                                    });
                                </script>
                            </div>
    
                            <!--Time Input-->
                            <div class="row">
                                <div class='col'>
                                    <h4>Expected amount of time to finish:</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class='col-md-6'>
                                    <div class="form-group">
                                    <label for="p_hours">Hours</label>
                                        <input id="p_hours" type='number' class="form-control entry" />
                                    </div>
                                </div>
                                <div class='col-md-6'>
                                    <div class="form-group">
                                    <label for="p_min">Minutes</label>
                                        <input id="p_min" type='number' class="form-control entry" />
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    document.getElementById('p_hours').onchange = function() {
                                        this.value = Math.max(0, parseInt(this.value));
                                    }

                                    document.getElementById('p_min').onchange = function() {
                                        this.value = Math.max(0, Math.min(59, parseInt(this.value)));
                                    }
                                </script>
                            </div>
                            
                            <!--Description-->
                            <div class="form-group">
                                <label for="p_desc">Project Description</label>
                                <textarea class="form-control entry" id="p_desc" rows="3"></textarea>
                            </div>
                        </div>
    
                        <!--Cancel and submit buttons-->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="clearAllEntries()">Cancel</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="createCalendarProject(updateUI)">Create Project</button>
                        </div>
                    </div>
                </div>
            </div>
    
            <!--Event Creation Fail Modal-->
            <div id="eventCreationFail" class="modal" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Failed to create event</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>One or more of the required entries for event creation was incomplete.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">OK</button>
                    </div>
                    </div>
                </div>
            </div>

            <!--Project Creation Fail Modal-->
            <div id="projectCreationFail" class="modal" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Failed to create project</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>One or more of the required entries for project creation was incomplete.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">OK</button>
                    </div>
                    </div>
                </div>
            </div>

            <!--Edit Event Modal-->
            <div class="modal fade" id="editEventModal" tabindex="-1" role="dialog" aria-labelledby="event-edit-modal" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Create Event</h5>
                        </div>
    
                        <!--Create Event Form-->
                        <div class="modal-body">
                            <!--Title-->
                            <div class="form-group">
                                <input type="text" class="form-control entry" id="e_title_edit" placeholder="Event Title">
                            </div>
    
                            <!--Time-->
                            <div class="row">
                                <div class='col-sm-6'>
                                    <div class="form-group">
                                        <label for="e_start_time_edit">Start Time</label>
                                        <div class='input-group date' id='datetimepicker1_edit'>
                                            <input id="est_edit" type='text' class="form-control entry" id="e_start_time_edit"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#datetimepicker1_edit').datetimepicker({
                                            format: 'LT'
                                        });
                                    });
                                </script>
                                <div class='col-sm-6'>
                                    <div class="form-group">
                                        <label for="e_end_time_edit">End Time</label>
                                        <div class='input-group date' id='datetimepicker2_edit'>
                                            <input id="eet_edit" type='text' class="form-control entry" id="e_end_time_edit"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#datetimepicker2_edit').datetimepicker({
                                            format: 'LT'
                                        });
                                    });
                                </script>
                            </div>
    
                            <!--Recurring-->
                            <div class="form-check">
                                <div class="row">
                                    <div class="col col-sm-4">
                                        <label for="recurring_edit"> Recurring Event </label>
                                    </div>
                                    <div class="col col-sm-1">
                                        <input class="form-check-input entry" type="checkbox" value="" id="recurring_edit">
                                    </div>
                                </div>
                            </div>
    
                            <!--Date Input-->
                            <div class="row">
                                <div class='col-md-6'>
                                    <div class="form-group">
                                        <label for="e_start_date_edit">Start Date</label>
                                        <div class='input-group date' id='e_start_date_edit'>
                                            <input id="esd_edit" type='text' class="form-control entry" />
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class='col-md-6'>
                                    <div class="form-group">
                                        <label for="e_end_date_edit">End Date</label>
                                        <div class='input-group date' id='e_end_date_edit'>
                                            <input disabled id="ed_edit" type='text' class="form-control entry" />
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    document.getElementById('recurring_edit').onchange = function() {
                                        document.getElementById('ed_edit').disabled = !this.checked;
                                    };
                                </script>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#e_start_date_edit').datetimepicker({
                                            format: "MM/DD/YYYY",
                                        });
                                        $('#e_end_date_edit').datetimepicker({
                                            format: "MM/DD/YYYY",
                                            useCurrent: false //Important! See issue #1075
                                        });
                                        $("#e_start_date_edit").on("dp.change", function (e) {
                                            $('#e_end_date').data("DateTimePicker").minDate(e.date);
                                        });
                                        $("#e_end_date_edit").on("dp.change", function (e) {
                                            $('#e_start_date').data("DateTimePicker").maxDate(e.date);
                                        });
                                    });
                                </script>
                            </div>
                            
                            <div class="row">
                                <div class="col">
                                    <label for="rec_edit">Recurrence</label>
                                    <select disabled class="custom-select mr-sm-2" id="rec_edit">
                                        <option selected>Choose...</option>
                                        <option value="1">Every</option>
                                        <option value="2">Every Other</option>
                                    </select>
                                </div>
                                <div class="col">
                                    <label class="mr-sm-2" for="timeframe_edit">Timeframe</label>
                                    <select disabled class="custom-select mr-sm-2 my-1" id="timeframe_edit">
                                        <option selected>Choose...</option>
                                        <option value="1">Day</option>
                                        <option value="2">Week</option>
                                        <option value="3">Month</option>
                                        <option value="4">Year</option>
                                    </select>
                                </div>
                                <script>
                                    document.getElementById('recurring_edit').onchange = function() {
                                        document.getElementById('rec_edit').disabled = !this.checked;
                                        document.getElementById('timeframe_edit').disabled = !this.checked;
                                        document.getElementById('ed_edit').disabled = !this.checked;
                                    };
                                </script>
                            </div>
                            <br>
                            
                            <!--Description-->
                            <div class="form-group">
                                <label for="e_desc_edit">Event Description</label>
                                <textarea class="form-control entry" id="e_desc_edit" rows="3"></textarea>
                            </div>
                        </div>
    
                        <!--Cancel and submit buttons-->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger" data-dismiss="modal" onclick="deleteEvent(updateUI)" style="float: left;">Delete Event</button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="clearAllEntries()">Cancel</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="saveEventChanges(updateUI)">Save Changes</button>
                            <p id="id-holder" style="display: none;"></p>
                        </div>
                    </div>
                </div>
            </div>

            <!--Edit Project Modal-->
            <div class="modal fade" id="editProjectModal" tabindex="-1" role="dialog" aria-labelledby="project-edit-modal" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLongTitle">Create Project</h5>
                        </div>

                        <!--Create Project Form-->
                        <div class="modal-body">
                            <!--Title-->
                            <div class="form-group">
                                <input type="text" class="form-control entry" id="p_title_edit" placeholder="Project Title">
                            </div>

                            <!--Time-->
                            <div class="row">
                                <div class='col-sm-6'>
                                    <div class="form-group">
                                        <label for="p_start_time_edit">Start Date</label>
                                        <div class='input-group date' id='datetimepickerPS_edit'>
                                            <input id="pst_edit" type='text' class="form-control entry" id="p_start_time_edit"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#datetimepickerPS_edit').datetimepicker({
                                            format: "MM/DD/YYYY"
                                        });
                                    });
                                </script>
                                <div class='col-sm-6'>
                                    <div class="form-group">
                                        <label for="p_end_time_edit">Due Date</label>
                                        <div class='input-group date' id='datetimepickerPE_edit'>
                                            <input id="pet_edit" type='text' class="form-control entry" id="p_end_time_edit"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        $('#datetimepickerPE_edit').datetimepicker({
                                            format: "MM/DD/YYYY"
                                        });
                                    });
                                </script>
                            </div>

                            <!--Time Input-->
                            <div class="row">
                                <div class='col'>
                                    <h4>Expected amount of time to finish:</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class='col-md-6'>
                                    <div class="form-group">
                                        <label for="p_hours_edit">Hours</label>
                                        <input id="p_hours_edit" type='number' class="form-control entry" />
                                    </div>
                                </div>
                                <div class='col-md-6'>
                                    <div class="form-group">
                                        <label for="p_min_edit">Minutes</label>
                                        <input id="p_min_edit" type='number' class="form-control entry" />
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    document.getElementById('p_hours_edit').onchange = function() {
                                        this.value = Math.max(0, parseInt(this.value));
                                    }

                                    document.getElementById('p_min_edit').onchange = function() {
                                        this.value = Math.max(0, Math.min(59, parseInt(this.value)));
                                    }
                                </script>
                            </div>

                            <!--Description-->
                            <div class="form-group">
                                <label for="p_desc_edit">Project Description</label>
                                <textarea class="form-control entry" id="p_desc_edit" rows="3"></textarea>
                            </div>
                        </div>

                        <!--Cancel and submit buttons-->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger" data-dismiss="modal" onclick="deleteProject(updateUI)" style="float: left;">Delete Event</button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="clearAllEntries()">Cancel</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="saveProjectChanges(updateUI)">Save Changes</button>
                            <p id="id-holder" style="display: none;"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            var user = new User();
            getAllEvents(updateUI);
            getAllProjects(updateUI);
            createCalendarTable();
            function incUserDate() { user.incDate(); updateUI(); }
            function decUserDate() { user.decDate(); updateUI(); }
        </script>
    </body>
</html>